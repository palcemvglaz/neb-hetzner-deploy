import { prisma } from '../lib/db/prisma'

async function createTestCourse() {
  try {
    console.log('Creating test course from KB_NEB content...')
    
    // Create course
    const course = await prisma.course.create({
      data: {
        slug: 'vision-concept-blocker',
        difficulty: 'BEGINNER',
        isPremium: true,
        isPublished: true,
        price: 299,
        translations: {
          create: {
            language: 'UA',
            title: 'Принцип "Бачити далеко" та блокери видимості',
            description: 'Навчіться ключовому принципу безпечної їзди - максимізації огляду дороги та роботі з блокерами видимості. Цей курс допоможе уникнути "раптових" аварій.',
            learningOutcomes: JSON.stringify([
              'Розуміння концепції блокерів видимості',
              'Правильне позиціонування на дорозі',
              'Техніки максимізації огляду',
              'Стратегії уникнення небезпеки'
            ]),
            requirements: JSON.stringify([
              'Базові навички керування мотоциклом',
              'Бажання навчитися безпечній їзді'
            ])
          }
        },
        sections: {
          create: [
            {
              title: 'Теоретична основа',
              description: 'Вивчіть основні принципи концепції "Бачити далеко"',
              order: 1,
              items: {
                create: [
                  {
                    order: 1,
                    isRequired: true,
                    content: {
                      create: {
                        type: 'TEXT',
                        title: 'Що таке принцип "Бачити далеко"?',
                        bodyUa: `Ідея проста: мотоциклісту **важливо завжди мати найкращий огляд і чітке уявлення про ситуацію на дорозі.**

Потрібно вибирати свою позицію і швидкість так, щоб максимально "бачити далеко".

**Стандартні помилки новачків:**
- Їздять за великими автівками посередині смуги
- Не бачать, що відбувається попереду
- Дізнаються про небезпеку в останній момент
- Дозволяють загрозам "раптово" з'являтися

Усі об'єкти, які обмежують огляд, називаються "блокерами видимості".`,
                        estimatedTime: 5,
                        tags: ['блокери', 'видимість', 'огляд', 'безпека']
                      }
                    }
                  },
                  {
                    order: 2,
                    isRequired: true,
                    content: {
                      create: {
                        type: 'TEXT',
                        title: 'Типи блокерів видимості',
                        bodyUa: `**Основні типи блокерів:**

1. **Великі транспортні засоби**
   - Вантажівки та автобуси
   - Тоновані автівки
   - Фургони та мікроавтобуси

2. **Стаціонарні об'єкти**
   - Припарковані автомобілі
   - Будівлі на поворотах
   - Рекламні щити
   - Зелені насадження

3. **Погодні умови**
   - Дощ та туман
   - Сонце, що сліпить
   - Темний візор вночі

**Правило:** Кожен блокер = потенційна загроза!`,
                        estimatedTime: 5,
                        tags: ['блокери', 'типи', 'небезпека']
                      }
                    }
                  }
                ]
              }
            },
            {
              title: 'Практичні навички',
              description: 'Навчіться застосовувати принцип на дорозі',
              order: 2,
              items: {
                create: [
                  {
                    order: 1,
                    isRequired: true,
                    content: {
                      create: {
                        type: 'TEXT',
                        title: 'Правильне позиціонування в потоці',
                        bodyUa: `**Оптимальна позиція для максимального огляду:**

1. **У лівій смузі** - тримайтеся праворуч
   - Бачите далеко крізь весь ряд
   - Можете завчасно помітити гальмування
   - Легко піти в міжряддя при потребі

2. **У правій смузі** - тримайтеся ліворуч
   - Уникаєте припаркованих авто
   - Маєте простір для маневру
   - Видно перехожих заздалегідь

3. **Дистанція**
   - Мінімум 2-3 секунди до авто попереду
   - Більше місця = більше часу на реакцію
   - Можливість бачити "через" авто попереду`,
                        estimatedTime: 7,
                        tags: ['позиція', 'потік', 'практика']
                      }
                    }
                  },
                  {
                    order: 2,
                    isRequired: false,
                    content: {
                      create: {
                        type: 'QUIZ',
                        title: 'Перевірка знань: Блокери видимості',
                        bodyUa: JSON.stringify({
                          questions: [
                            {
                              question: "Що робити при наближенні до припаркованої вантажівки?",
                              options: [
                                "Проїхати швидко повз неї",
                                "Сповільнити та очікувати загрозу",
                                "Зупинитися перед вантажівкою",
                                "Сигналити"
                              ],
                              correctAnswer: 1,
                              explanation: "Потрібно сповільнити та очікувати потенційну загрозу з-за блокера"
                            },
                            {
                              question: "Яка оптимальна позиція в лівій смузі?",
                              options: [
                                "Зліва",
                                "По центру",
                                "Справа",
                                "Постійно змінювати"
                              ],
                              correctAnswer: 2,
                              explanation: "Справа в лівій смузі - для максимального огляду через потік"
                            }
                          ]
                        }),
                        estimatedTime: 5,
                        tags: ['тест', 'перевірка']
                      }
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    })
    
    console.log('✅ Test course created successfully!')
    console.log(`Course ID: ${course.id}`)
    console.log(`Slug: ${course.slug}`)
    
  } catch (error) {
    console.error('Error creating test course:', error)
  } finally {
    await prisma.$disconnect()
  }
}

createTestCourse()